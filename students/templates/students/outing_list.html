{% extends 'officials/base_officials.html' %}

{% block title %}Outing History{% endblock title %}

{% load qr_code %}
{% block content %}
<h2 class="text-center">Outing History</h2>
<hr />

<h4 class="ml-4">Upcoming Outings</h4>
<div class="overflow-auto p-3">
  <table class="table table-hover table-muted table-striped">
    <thead>
      <tr>
        <th>ID</th>
        <th>From</th>
        <th>To</th>
        <th>Type</th>
        <th>Purpose of Visit</th>
        <th>Parent Consent</th>
        <th>Remark by Caretaker</th>
        <th>Remark by Warden</th>
        <th>Permission</th>
        <th>Action</th>
        <th>Cancel</th>
      </tr>
    </thead>
    <tbody>
      {% for outing in outing_list %}
        {% if outing.is_upcoming %}
          <tr
            {% if outing.is_qr_viewable %}
            data-row-href="{% url 'students:outing_QRCode' outing.pk %}"
            {% endif %}
          >
            <td>{{ outing.id }}</td>
            <td nowrap>{{ outing.fromDate }}</td>
            <td nowrap>{{ outing.toDate }}</td>
            <td>{{ outing.type }}</td>
            <td>{{ outing.purpose }}</td>
            <td>{{ outing.parent_consent }}</td>
            <td>{{ outing.remark_by_caretaker }}</td>
            <td>{{ outing.remark_by_warden }}</td>
            <td
              {% if outing.permission == 'Pending' or outing.permission == 'Processing' or outing.permission == 'Pending Extension' or outing.permission == 'Processing Extension' %}
                class="text-primary"
              {% endif %}
              {% if outing.permission == 'Granted' or outing.permission == 'In Outing' %}
                class="text-success"
              {% endif %}
              {% if outing.permission == 'Rejected' or outing.permission == 'Revoked' or outing.permission == 'Closed' %}
                class="text-danger"
              {% endif %}
            >
              {{ outing.permission }}
            </td>
            <td nowrap>
              {% if outing.is_editable %}
                <a href="{% url 'students:outing_edit' outing.id %}" target="_blank" class="btn btn-primary">Edit</a>
              {% else %}
              {% if outing.is_extendable %}
                <a href="{% url 'students:outing_edit' outing.id %}" target="_blank" class="btn btn-primary">Extend</a>
              {% endif %}
              {% endif %}

            </td>
            <td>
              {% if outing.can_cancel %}
              <form action="{% url 'students:outing_cancel' outing.id %}" method="post" onsubmit="return confirm('Are you sure you want to cancel outing ?');">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">Cancel</button>
              </form>
              {% endif %}
            </td>
          </tr>
        {% endif %}
      {% endfor %}
    </tbody>
  </table>
</div>

<h4 class="ml-4">Past Outings</h4>
<div class="overflow-auto p-3">
  <table class="table table-hover table-muted table-striped">
    <thead>
      <tr>
        <th>ID</th>
        <th>From</th>
        <th>To</th>
        <th>Type</th>
        <th>Purpose of Visit</th>
        <th>Parent Consent</th>
        <th>Remark by Caretaker</th>
        <th>Remark by Warden</th>
        <th>Permission</th>
        <th>Action</th>
        <th>Cancel</th>
      </tr>
    </thead>
    <tbody>
      {% for outing in outing_list %}
        {% if not outing.is_upcoming %}
          <tr>
            <td>{{ outing.id }}</td>
            <td nowrap>{{ outing.fromDate }}</td>
            <td nowrap>{{ outing.toDate }}</td>
            <td>{{ outing.type }}</td>
            <td>{{ outing.purpose }}</td>
            <td>{{ outing.parent_consent }}</td>
            <td>{{ outing.remark_by_caretaker }}</td>
            <td>{{ outing.remark_by_warden }}</td>
            <td
            {% if outing.permission == 'Pending' or outing.permission == 'Processing' or outing.permission == 'Pending Extension' or outing.permission == 'Processing Extension' %}
              class="text-primary"
            {% endif %}
            {% if outing.permission == 'Granted' or outing.permission == 'In Outing' %}
              class="text-success"
            {% endif %}
            {% if outing.permission == 'Rejected' or outing.permission == 'Revoked' or outing.permission == 'Closed' %}
              class="text-danger"
            {% endif %}
            >
              {{ outing.permission }}
            </td>
            <td nowrap>
              {% if outing.is_editable %}
                <a href="{% url 'students:outing_edit' outing.id %}" target="_blank" class="btn btn-primary">Edit</a>
              {% endif %}
            </td>
            <td>
            </td>
          </tr>
        {% endif %}
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock content %}
